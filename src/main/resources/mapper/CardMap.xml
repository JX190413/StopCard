<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--这个是要引用的SQL语句类型文件夹-->
<mapper namespace="com.cykj.stopcard.dao.CarDao">

    <!--    查询空闲车位-->
    <select id="searchFreeCardPort" resultType="CardPort">
    SELECT * FROM tbl_carport WHERE stateid='5';
    </select>

    <!--    车辆入场-->
    <insert id="CarIn">
        INSERT INTO
        tbl_inout (carnum,intime,portname,stateid)
        VALUES (#{carnum},#{intime},#{portname},#{stateid})
    </insert>

    <!--    修改车位状态-->
    <update id="updatePortState">
    UPDATE  tbl_carport SET stateid=#{stateid} WHERE portname=#{portname}
    </update>

    <!--    反向寻车-->
    <select id="searchCardPort" resultType="CardPort">
        SELECT A.* FROM tbl_carport A,tbl_inout B
        WHERE A.portname=B.portname
        AND  B.portname=(SELECT portname FROM `tbl_inout` WHERE carnum=#{carnum} and outtime is null)
    </select>

    <!--    所有车位信息查询-->
    <select id="carPortQuery" resultType="CardPort">
        SELECT * FROM tbl_carport
    </select>

    <!--    被点击车位信息查询-->
    <select id="carPortClick" resultType="CardPort">
        SELECT * FROM tbl_carport WHERE portcardid=#{ID}
    </select>

    <!--    获取分区标注信息-->
    <select id="carArea" resultType="Area">
        SELECT DISTINCT portarea,belong FROM tbl_carport order by belong
    </select>

    <!--    动态修改分区-->
    <update id="changeArea">
        UPDATE tbl_carport SET portarea=#{portarea} WHERE belong = #{belong}
    </update>

</mapper>
